<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Invitación de Boda</title>

<!-- Fuentes -->
<link href="https://fonts.googleapis.com/css2?family=Dancing+Script&family=Great+Vibes&family=Montserrat&display=swap" rel="stylesheet">

<!-- Iconos -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
/* Video de fondo centrado */
#fondoVideo {
  position: fixed;
  top: 25%;
  left: 50%;
  transform: translate(-50%, -50%);
  min-width: 100%;
  min-height: 100%;
  object-fit: cover;
  z-index: -2;
}

/* Overlay para mejorar legibilidad */
.overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(255, 255, 255, 0.2); 
  backdrop-filter: blur(5px);
  z-index: -1;
}

/* Contenedor principal */
body {
  margin: 0;
  font-family: 'Montserrat', sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  text-align: center;
  padding: 1rem;
  color: #960018; /* rojo intenso para texto general */
}

/* Tarjeta de invitación */
.card-romantica {
  max-width: 600px;
  background: rgba(255, 255, 255, 0.85);
  border-radius: 25px;
  padding: 2rem;
  box-shadow: 0 8px 25px rgba(0,0,0,0.25);
  animation: fadeIn 2s ease-in-out;
  color: #960018; /* asegurar que todo dentro sea rojo */
}

/* Títulos */
h1 {
  font-family: 'Great Vibes', cursive;
  font-size: 3rem;
  margin-bottom: 0.2rem;
  color: #960018; /* rojo intenso */
}
h2 {
  font-family: 'Dancing Script', cursive;
  font-size: 2rem;
  margin-top: 0;
  color: #960018; /* rojo intenso */
}
h3 {
  font-family: 'Dancing Script', cursive;
  font-size: 1.5rem;
  margin: 0.5rem 0;
  color: #960018; /* rojo intenso */
}

/* Separadores decorativos */
.separador {
  border: 0;
  height: 2px;
  width: 80%;
  margin: 2rem auto;
  background: linear-gradient(to right, transparent, #960018, transparent); /* rojo degradado */
}

/* Contador */
.contador {
  font-size: 1.2rem;
  font-weight: bold;
  margin: 1rem 0;
  color: #960018; /* rojo intenso */
}

/* Botones */
.btn {
  font-family: 'Dancing Script', cursive;
  font-size: 1.1rem;
  color: #fff;
  background: #960018; /* rojo sólido */
  border: none;
  padding: 0.8rem 1.6rem;
  border-radius: 999px;
  cursor: pointer;
  box-shadow: 0 6px 15px rgba(0,0,0,0.2);
  margin-top: 1rem;
  transition: transform 0.3s, box-shadow 0.3s;
}
.btn:hover {
  transform: scale(1.08);
  box-shadow: 0 10px 20px rgba(0,0,0,0.3);
  background: #d50000; /* rojo más oscuro al pasar mouse */
}

/* Animaciones */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Responsive */
@media (max-width: 768px) {
  h1 { font-size: 2.2rem; }
  h2 { font-size: 1.5rem; }
  .card-romantica { padding: 1.5rem; }
}
</style>
</head>
<body>

<!-- Video de fondo -->
<video autoplay muted loop id="fondoVideo">
  <source src="video-fondo.mp4" type="video/mp4">
  Tu navegador no soporta videos HTML5
</video>

<div class="overlay"></div>

<!-- Tarjeta de invitación -->
<div class="card-romantica">
  <h1>Jonatan & Ludmila</h1>
  <h2><i class="fa-solid fa-heart"></i> ¡Nos casamos! <i class="fa-solid fa-heart"></i></h2>

  <hr class="separador">

  <p class="contador">Faltan: <span id="contador"></span></p>

  <hr class="separador">

  <h2>Hola, los invitamos a nuestra boda</h2>
  <h3 id="nombreInvitado">Invitado</h3>

  <!-- Selección de invitados -->
  <p>¿Cuántos asistirán?</p>
  <select id="invitadosSelect"></select>

  <br><br>

  <!-- Botón para confirmar asistencia -->
  <button class="btn" id="btnConfirmar">💌 Confirmar Asistencia</button>

  <br><br>

  <!-- Botón de música -->
  <button class="btn" id="btnMusica">🎵 Reproducir Música</button>

  <br><br>
  <!-- Botón de ubicación -->
  <a href="https://maps.app.goo.gl/dE5ZwpyMcKssvmyQ6" target="_blank" class="btn">📍 Ver Ubicación del Salón</a>
</div>

<!-- Música -->
<audio id="musicaFondo" loop>
  <source src="a-thousand-years.mp3" type="audio/mp3">
</audio>

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
import { getFirestore, doc, getDoc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCH6S96lGMbUManPhCkXqHFQGPCdJ_7hkg",
  authDomain: "invitacion-boda-14.firebaseapp.com",
  projectId: "invitacion-boda-14",
  storageBucket: "invitacion-boda-14.firebasestorage.app",
  messagingSenderId: "792408500001",
  appId: "1:792408500001:web:7c0998db3821fe03280060"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const urlParams = new URLSearchParams(window.location.search);
const invitadoID = urlParams.get('id') || 'fam1'; // default fam1 si no hay ID
const nombreInvitado = document.getElementById('nombreInvitado');
const select = document.getElementById("invitadosSelect");
const btnConfirmar = document.getElementById("btnConfirmar");

// Cargar invitado y generar select dinámico según maxInvitados
async function cargarInvitado() {
  const docRef = doc(db, "invitados", invitadoID);
  const docSnap = await getDoc(docRef);
  if (docSnap.exists()) {
    const data = docSnap.data();
    nombreInvitado.textContent = data.nombre || "Invitado";
    const max = data.maxInvitados || 1;
    select.innerHTML = "";
    for (let i = 1; i <= max; i++) {
      const option = document.createElement("option");
      option.value = i;
      option.textContent = i === 1 ? "1 Persona" : `${i} Personas`;
      select.appendChild(option);
    }
  } else {
    nombreInvitado.textContent = "Invitado";
    select.innerHTML = "<option value='1'>1 Persona</option>";
  }
}

// Verificar si ya confirmó
async function verificarConfirmacion() {
  const docRef = doc(db, "confirmaciones", invitadoID); // usamos invitadoID como ID único
  const docSnap = await getDoc(docRef);
  if (docSnap.exists()) {
    select.disabled = true;
    btnConfirmar.disabled = true;
    alert("Ya confirmaste tu asistencia. ¡Gracias! 😄");
  }
}

cargarInvitado();
verificarConfirmacion();

// Contador de días
const fechaBoda = new Date("Feb 14, 2026 18:00:00").getTime();
const contador = document.getElementById("contador");
setInterval(() => {
  const ahora = new Date().getTime();
  const diff = fechaBoda - ahora;
  const meses = Math.floor(diff / (1000 * 60 * 60 * 24 * 30));
  const dias = Math.floor((diff % (1000 * 60 * 60 * 24 * 30)) / (1000 * 60 * 60 * 24));
  const horas = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
  const minutos = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
  const segundos = Math.floor((diff % (1000 * 60)) / 1000);
  contador.innerHTML = `${meses} meses ${dias} días ${horas}h ${minutos}m ${segundos}s`;
}, 1000);

// Botón de música
const btnMusica = document.getElementById("btnMusica");
const musica = document.getElementById("musicaFondo");
btnMusica.addEventListener("click", () => {
  if (musica.paused) {
    musica.play();
    btnMusica.textContent = "🔇 Pausar Música";
  } else {
    musica.pause();
    btnMusica.textContent = "🎵 Reproducir Música";
  }
});

// Confirmar asistencia
btnConfirmar.addEventListener("click", async () => {
  const numPersonas = parseInt(select.value);
  const docRef = doc(db, "confirmaciones", invitadoID);
  const docSnap = await getDoc(docRef);

  if (docSnap.exists()) {
    alert("Ya confirmaste tu asistencia. ¡Gracias! 😄");
    return;
  }

  try {
    await setDoc(docRef, {
      invitadoID,
      numPersonas,
      confirmado: true,
      timestamp: serverTimestamp()
    });
    alert(`¡Gracias por confirmar! Número de invitados: ${numPersonas}`);
    select.disabled = true;
    btnConfirmar.disabled = true;
  } catch (error) {
    console.error("Error al guardar confirmación:", error);
    alert("Ocurrió un error, intenta nuevamente.");
  }
});
</script>
</body>
</html>







